(()=>{"use strict";const e=(e,t,n,s,i="block")=>{const a=document.querySelector(e),c=document.querySelectorAll(t),r=document.querySelectorAll(n);function o(){r.forEach((e=>{e.style.display="none"})),c.forEach((e=>{e.classList.remove(s)}))}function l(e=0){try{r[e].style.display=i}catch(e){}try{c[e].classList.add(s)}catch(e){}}o(),l();try{a.addEventListener("click",(e=>{e.preventDefault(),e.target&&(e.target.classList.contains(t.replace(/\./,""))||e.target.parentNode.classList.contains(t.replace(/\./,"")))&&c.forEach(((t,n)=>{e.target!=t&&e.target.parentNode!=t||(o(),l(n))}))}))}catch(e){}},t=()=>{let e=!1;function t(t,s,i,a=!1){const c=document.querySelectorAll(t),r=document.querySelector(s),o=document.querySelector(i),l=document.querySelectorAll("[data-modal]"),d=n();c.forEach((t=>{t.addEventListener("click",(n=>{n.target&&n.preventDefault(),e=!0,a&&t.remove(),l.forEach((e=>{e.style.display="none",e.classList.add("animated","fadeIn")})),r.style.display="flex",document.body.style.overflow="hidden",document.body.style.marginRight=`${d}px`}))})),o.addEventListener("click",(()=>{l.forEach((e=>{e.style.display="none"})),r.style.display="none",document.body.style.overflow="",document.body.style.marginRight="0px"})),r.addEventListener("click",(e=>{e.target===r&&(l.forEach((e=>{e.style.display="none"})),r.style.display="none",document.body.style.overflow="",document.body.style.marginRight="0px")}))}function n(){let e=document.createElement("div");e.style.width="50px",e.style.height="50px",e.style.overflowY="scroll",e.style.visibility="hidden",document.body.appendChild(e);let t=e.offsetWidth-e.clientWidth;return e.remove(),t}var s;t(".vacansy",".popup-booking",".popup-booking .popup__close"),t(".profile",".popup-input",".popup-input .popup__close"),t(".reestablish",".popup-recovery",".popup-recovery .popup__close"),t(".registration",".popup-registration",".popup-registration .popup__close"),t(".subsribe",".popup-subscription",".popup-subscription .popup__close"),t(".registration-completed",".popup-cheack-phone",".popup-cheack-phone .popup__close"),t(".cancel",".popup-input",".popup-input .popup__close"),s=".subsribe",window.addEventListener("scroll",(()=>{let t=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);!e&&window.pageYOffset+document.documentElement.clientHeight>=t&&document.querySelector(s).click()}))};class n{constructor(){this.burgerMenu=document.querySelector(".header nav.navbar .navbar-toggler"),this.orderMenu=document.querySelector(".vacansy")}init(){this.openBurger(),this.closeBurger(),this.closeOrder()}openBurger(){this.burgerMenu.addEventListener("click",(()=>{document.body.style.overflow="hidden"}))}closeBurger(){this.burgerMenu.addEventListener("click",(()=>{this.burgerMenu.classList.contains("collapsed")&&(document.body.style.overflow="")}))}closeOrder(){this.orderMenu.addEventListener("click",(()=>{this.closeBurger(),this.burgerMenu.click()}))}}class s{constructor(e){this.forms=document.querySelectorAll(e),this.btn=document.querySelector("button"),this.inputs=document.querySelectorAll("input"),this.textareas=document.querySelectorAll("textarea"),this.message={loading:"Загрузка...",success:"Спасибо! Скоро мы с вами свяжемся!",failure:"Что-то пошло не так...",input:"Вы вошли",registration:"Вы Зарегистрировались",booking:"Вы забронировали",reviews:"Спасибо, что оставили отзыв",recovery:"Пароль восстановлен",cheack:"Отлично! Телефон проверен",subscribe:"Спасибо! вы будете получать уведомления",person:"Информация изменена"},this.path="../../server.php"}clearInputs(){this.inputs.forEach((e=>{e.value=""}))}clearTextareas(){this.textareas.forEach((e=>{e.value=""}))}checkMailInputs(){document.querySelectorAll('[type="email"]').forEach((e=>{e.addEventListener("keypress",(function(e){e.key.match(/[^a-z 0-9 @ \.]/gi)&&e.preventDefault()}))}));document.querySelectorAll('[type="name"]').forEach((e=>{e.addEventListener("keypress",(function(e){e.key.match(/[^а-яё]/gi)&&e.preventDefault()}))}))}initMask(){function e(e){let t="+380 (__) __-__",n=0,s=t.replace(/\D/g,""),i=this.value.replace(/\D/g,"");s.length>=i.length&&(i=s),this.value=t.replace(/./g,(function(e){return/[_\d]/.test(e)&&n<i.length?i.charAt(n++):n>=i.length?"":e})),"blur"===e.type?2==this.value.length&&(this.value=""):((e,t)=>{if(t.focus(),t.setSelectionRange)t.setSelectionRange(e,e);else if(t.createTextRange){let n=t.createTextRange();n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",e),n.select()}})(this.value.length,this)}document.querySelectorAll('[type="phone"]').forEach((t=>{t.addEventListener("input",e),t.addEventListener("focus",e),t.addEventListener("blur",e)}))}async postData(e,t){let n=await fetch(e,{method:"POST",body:t});return await n.text()}init(){this.checkMailInputs(),this.initMask(),this.btn.disabled=!1,this.forms.forEach((e=>{e.addEventListener("submit",(t=>{t.preventDefault();let n=document.createElement("div");n.classList.add("statusMessages"),e.parentNode.appendChild(n),n.textContent=this.message.loading;const s=new FormData(e);this.postData(this.path,s).then((t=>{switch(console.log(t),!0){case e.classList.contains("entrance"):n.textContent=this.message.input;break;case e.classList.contains("registr"):n.textContent=this.message.registration;break;case e.classList.contains("subscribe"):n.textContent=this.message.subscribe;break;case e.classList.contains("cheackPhone"):n.textContent=this.message.cheack;break;case e.classList.contains("recovering"):n.textContent=this.message.recovery;break;case e.classList.contains("reviews"):n.textContent=this.message.reviews;break;case e.classList.contains("bookings"):n.textContent=this.message.booking;break;case e.classList.contains("page__container-content-person"):n.textContent=this.message.person;break;default:n.textContent=this.message.success}})).catch((()=>{n.textContent=this.message.failure})).finally((()=>{this.clearInputs(),this.clearTextareas(),this.btn.disabled=!0,setTimeout((()=>{n.remove(),this.btn.disabled=!1}),5e3)}))}))}))}}const i=(e,t={},n)=>{const s=document.getElementById(e),i=document.querySelector(n);try{s.addEventListener("change",(e=>{if(console.log(e.target.files),!e.target.files.length)return;Array.from(e.target.files).forEach((e=>{if(console.log(e),!e.type.match("image"))return;const t=new FileReader;t.onload=e=>{console.log(e.target.result),i.insertAdjacentHTML("afterbegin",`<img src="${e.target.result}" />`)},t.readAsDataURL(e)}))}))}catch(e){}try{t.accept&&Array.isArray(t.accept)&&s.setAttribute("accept",t.accept.join(","))}catch(e){}},a=e=>{const t=document.querySelector(e);let n;document.querySelectorAll(".pagination li");!async function(){const e=await fetch("./products.json"),s=await e.json();(function(e){e.forEach((e=>{n=`\n                    <div class="product" data-id="${e.id}">\n                        <div class="product-img">\n                            <img product-image src="${e.imgSrc}" alt="">\n                        </div>\n                        <a href="./description.html" class="product-title">\n                            ${e.title}\n                        </a>\n                        <div class="product-description">\n                            ${e.description}\n                        </div>\n                        <div class="product-rating">\n                            ${e.rating}\n                        </div>\n                        <div class="price-kol">\n                            <div class="price-kol__prev btn-kol" data-action="minus">\n                            -\n                            </div>\n                            <span data-counter>1</span>\n                            <div class="price-kol__next btn-kol" data-action="plus">\n                                +\n                            </div>\n                        </div>\n                        <div class="product-price">\n                            <b><span class="price-products">${e.price}</span>₽/кг</b> <span>За 500гр.</span>\n                        </div>\n                        <a href="" class="product-to-basket" data-cart>В корзину</a>\n                    </div>\n                    `,t.insertAdjacentHTML("beforeend",n)}))})(s),console.log(s)}()};class c extends class{constructor({container:e=null,btns:t=null,next:n=null,prev:s=null,dots:i=null,sliders:a=null,activeClass:c="",animate:r,autoplay:o}={}){this.container=document.querySelector(e);try{this.slides=this.container.children}catch(e){}this.btns=document.querySelectorAll(t),this.prev=document.querySelector(s),this.next=document.querySelector(n),this.dots=document.querySelectorAll(i),this.sliders=document.querySelectorAll(a),this.activeClass=c,this.animate=r,this.autoplay=o,this.slideIndex=1}}{constructor(e,t,n,s,i){super(e,t,n,s,i)}nextSlide(){"BUTTON"==this.slides[1].tagName&&"BUTTON"==this.slides[2].tagName?(this.container.appendChild(this.slides[0]),this.container.appendChild(this.slides[1]),this.container.appendChild(this.slides[2])):this.container.appendChild(this.slides[0])}bindTriggers(){this.next.addEventListener("click",(()=>this.nextSlide())),this.prev.addEventListener("click",(()=>{for(let e=this.slides.length-1;e>0;e--)if("BUTTON"!==this.slides[e].tagName){let t=this.slides[e];this.container.insertBefore(t,this.slides[0]);break}}))}init(){try{this.bindTriggers(),this.autoplay&&setInterval((()=>this.nextSlide()),5e3)}catch(e){}}}const r=()=>{document.querySelectorAll("[data-slide]").forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),e.classList.toggle("active-class-checked")}))}))};window.addEventListener("click",(function(e){let t;if("plus"===e.target.dataset.action||"minus"===e.target.dataset.action){t=e.target.closest(".price-kol").querySelector("[data-counter]")}"plus"===e.target.dataset.action&&(t.innerText=++t.innerText),"minus"===e.target.dataset.action&&(parseInt(t.innerText)>1?t.innerText=--t.innerText:e.target.closest(".product-slider")&&1===parseInt(t.innerText)&&(console.log("IN CART!!!!"),e.target.closest(".product-slider-block").remove(),toggleCartStatus(),calcCartPriceAndDelivery())),e.target.hasAttribute("data-action")&&e.target.closest(".product-slider")&&calcCartPriceAndDelivery()})),window.addEventListener("click",(function(e){const t=document.querySelector(".product-slider");if(e.target.hasAttribute("data-cart")){e.preventDefault();const n=e.target.closest(".product"),s={id:n.dataset.id,imgSrc:n.querySelector("[product-image]").getAttribute("src"),title:n.querySelector(".product-title").innerText,price:n.querySelector(".price-products").innerText,counter:n.querySelector("[data-counter]").innerText},i=`\n            <div class="product-slider-block" data-id="${s.id}">\n                <a href=""><img src="img/secondary-icons/cross-close.svg" alt=""></a>\n                <div class="photo-product">\n                    <img src="${s.imgSrc}" alt="">\n                </div>\n                <span class="name-product">${s.title}</span>\n                <div class="price-kol">\n                    <div class="price-kol__prev btn-kol" data-action="minus">\n                        -\n                    </div>\n                    <span data-counter>${s.counter}</span>\n                    <div class="price-kol__next btn-kol" data-action="plus">\n                        +\n                    </div>\n                </div>\n                <div class="price">\n                    <span>${s.price}</span>\n                </div>\n            </div>`;try{t.insertAdjacentHTML("beforeend",i)}catch(e){}n.querySelector("[data-counter]").innerText="1"}})),window.FLS=!0,window.addEventListener("DOMContentLoaded",(()=>{e(".tabs-info-slider",".tabs-info-block",".info-content","active-class-tabs-green"),e(".tabs-info",".tabs-form-info",".content-form","active-class-checked"),e(".page__container-tabs-content",".tabs-info",".content-profile","active-class-tab-profile","flex"),e(".pagination",".pagin-link",".products-wrapper","active-class-checked","flex"),e(".title-sliders",".title-slides",".block-slide","active-title-slide"),t(),(new n).init(),new s("form").init(),i("inputfile",{accept:[".png",".jpg",".jpeg",".gif"]},".photo"),a(".products-wrapper");new c({container:".page__container-menu-slider",prev:".page__container-menu .prev__arrow",next:".page__container-menu .next__arrow",autoplay:!1}).init(),r()}))})();